{% extends "base.html" %}
{% block title %}Home{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h3 class="mb-0">Device Inventory</h3>
      <small class="text-muted">
        Welcome, {{ user.first_name }}{% if user.is_admin %} (Admin){% endif %}
      </small>
    </div>

    {% if user.is_admin %}
    <a href="#" class="btn btn-sm btn-primary">
      + Add Device
    </a>
    {% endif %}
  </div>

  {% if devices %}
  <div class="table-responsive">
    <table class="table table-striped table-hover table-sm">
      <thead class="thead-dark">
        <tr>
          <th scope="col">ID</th>
          <th scope="col">Name</th>
          <th scope="col">Category</th>
          <th scope="col">Status</th>
          <th scope="col">Assigned To</th>
          <th scope="col">Location</th>
          <th scope="col">Added</th>
          {% if user.is_admin %}
          <th scope="col" class="text-right">Actions</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
        {% for device in devices %}
        <tr>
          <td>{{ device.id }}</td>
          <td>{{ device.name }}</td>
          <td>{{ device.category }}</td>
          <td>
            <span class="badge 
              {% if device.status == 'Available' %}badge-success
              {% elif device.status == 'In Use' %}badge-info
              {% else %}badge-warning{% endif %}">
              {{ device.status }}
            </span>
          </td>
          <td>
            {% if device.owner %}
              {{ device.owner.first_name }} ({{ device.owner.email }})
            {% else %}
              <span class="text-muted">Unassigned</span>
            {% endif %}
          </td>
          <td>{{ device.location or '-' }}</td>
          <td>{{ device.created_at.strftime('%Y-%m-%d') if device.created_at else '-' }}</td>

          {% if user.is_admin %}
          <td class="text-right">
            <a href="#" class="btn btn-sm btn-outline-secondary">Edit</a>
            <button class="btn btn-sm btn-outline-danger" onclick="deleteDevice({{ device.id }})">
              Delete
            </button>
          </td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="alert alert-info">
    {% if user.is_admin %}
      No devices in the system yet. Click <strong>+ Add Device</strong> to create one.
    {% else %}
      No devices assigned to you yet. Please contact your admin.
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}
